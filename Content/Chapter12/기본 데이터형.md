12장 기본 데이터형

o 특정한 데이터형을 다룬다는 것은 각 형에 대해 많은 개별적인 규칙을 기억한다는 것을 의미한다. 이 장에서 소개한 체크리스트를 이용하여 발생할 수 있는 일반적인 문제점을 고려했는지 확인한다.

o 사용하는 언어가 지원한다면 사용자 정의 형을 생성하여 프로그램을 변경하기 쉽고 많은 것을 스스로 문서화하게 만들 수 있다.

o typedef나 이와 비슷한 기능을 사용하여 간단한 형을 생성할 때 새로운 클래스를 생성해야 할지 고려한다.

 

부동소수점

a. 서로 크기가 매우 다른 수를 더하거나 빼지 않는다.

b.동치 비교를 피한다.

- 같아야 하는 부동 소수점 수가 항상 같지는 않다.

부동 소수점을 잘못 비교한 자바 예제

double nominal = 1.0;

double sum = 0.0;

 

for( int I = 0; I < 10; I++)

{

sum += 0.1;

}

if( nominal == sum )

{

System.out.println( “same numbers” );

}

else

{

System.out.println( “diff numbers” );

}

부동 소수점 수를 비교하는 자바 예제

final double ACCEPTABLE_DELTA = 0.0001;

boolean Equals( double Term1, double Term2 )

{

if( Math.abs( Term1 – Term2 ) < ACCEPTABLE_DELTA )

{

return true;

}

else

{

return false;

}

}

c. 라운딩 오류를 예측한다.

- 라운딩 오류 문제는 크기가 매우 다른 두 수에서 발생하는 문제와 다르지 않다.

해결책

- 더 큰 정밀도를 갖는 변수형으로 변경한다. 단정도(single-precision) 부동 소수점을 사용하고 있다면 배정도(double-precision) 부동 소수점을 변경한다.

- 이진화 십진 표기법(BCD, binary coded decimal) 변수로 변경한다.

- 부동 소수점을 정수형 변수로 변경한다. 이것이 BCD 변수를 직접 작성하는 방법이다.

d. 특정한 데이터형을 지원하는 언어와 라이브러리가 있는지 확인한다.

 

문자와 문자열

a. 매직 문자와 문자열을 사용하지 않는다.

- 매직 문자는 리터럴 문자(예: ‘A’)고 매직 문자열 프로그램 전체에 나타나는 리터럴 문자열(예:“기가매틱 회계 프로그램”)이다.

b. 하나 차이로 인한(off-by-one) 오류를 주의한다.

- 부분 문자열은 배열처럼 인덱스로 나타낼 수 있기에 문자열의 범위를 지나서 읽거나 쓰는, 하나 차이로 인한 오류에 주의한다.

c. 자신이 사용하고 있는 언어와 환경에서 유니코드를 어떻게 지원하는지 알아둔다.

d. 국제화/지역화 전략을 초기에 결정한다.

- 국제화와 지역화에 관련된 사항은 중요한 사항이다. 가장 중요하게 고려해야 할 사항은 외부 리소스에 모든 문자열을 저장해야 할지, 그리고 각 언어에 대한 개별적인 빌드를 생성할지 아니면 실행 시 특정 언어를 결정할지를 결정하는 것이다.

e. 알파벳 기반의 단일 언어를 지원할 필요가 있다는 사실을 안다면 ISO 8859 문자 집합 사용을 고려한다.

f. 다중 언어를 지원해야 한다면 유니코드를 사용한다.

g. 문자열 형 사이에 일관도니 변환 전략을 결정한다.

 

열거형

a. 가독성 향상을 위해 열거형을 사용하라.

b. 안정성을 위해 열거형을 사용하라.

c. 변경하기 쉽게 열거형을 사용하라.

d. 불린 변수에 대한 대안으로 열거형을 사용하라.

e. 유효하지 않은 값을 검사하라.

- if나 case 문에서 열거형을 사용할 때 유효하지 않은 값을 검사한다. 유효하지 않은 값을 잡기 위해서 case 문에서 else 절을 사용한다.

f. 반복문의 범위를 지정하기 위하여 열거의 처음과 마지막 항목을 정의하라.

g. 열거형의 첫 번째 항목을 유효하지 않은 값으로 남겨라.

- 열거형을 선언할 때 첫 번째 값을 유효하지 않은 값으로 남겨둔다. 많은 컴파일러는 열거형의 첫 번째 요소를 0으로 할당한다. 0으로 매핑된 요소를 유효하지 않은 값으로 선언하면 초기화되지 않은 변수는 0일 확률이 높기때문에 그런 변수를 잡는 데 도움을 준다.

h. 프로젝트 코드 작성 표준에서 처음과 마지막 요소가 어떻게 사용될 것인지를 정확하게 정의한 후 일관성 있게 사용하다.

i. 열거형의 요소에 명시적인 값을 할당할 때 발생할 수 있는 위험 요소를 주의하라